---
title: 3、http和表单
tags: 
notebook: kkb
---

## HTTP

### 数据交互

1. 表单：最基本的，最简单的。表单的提交成功率比 ajax 高，表单提交是浏览器实现的，ajax 是 js 实现的

2. jsonp：快被淘汰，安全性太差了。

3. ajax：不用刷新，跨域比较麻烦，单向通信，单向通信只能客户端去请求服务端，服务端数据变了没法通知客户端。

4. WebSocket：性能比ajax高很多，双向通信，服务端数据一有变化客户端能收到通知，默认就可以跨域。

> 除了websocket，其他方式的数据请求实际上对于后台来说都是表单。

### HTTP协议

**https 和 http**
s是 security，128位加密，google 致力于推广 https 消灭 http。https 要申请才行，因为需要一个身份（第三方权威机构的证书），阿里云的证书是免费的。

#### HTTP版本

1. http1.0：一次性连接

2. http1.1：比 http1.0 多了个保持连接，每次都重连很影响性能，所以保持连接提升了很大的性能

3. http2.0：目前是草案，具有革新性的协议：强制 https、自带双向通信、多路复用（很多个文件可以在一个连接中传输）

#### HTTP协议

RFC：一系列以编号排定的文件，互联网所有的协议，标准版本都叫 RFC。

**三次握手**

http 的三次握手其实就是 TCP 的三次握手

1. 客户端————1次，连接请求————>服务器
2. 客户端<————2次，有可能拒绝、也可能接受————服务器
3. 客户端————3次，假设接受了，发送请求数据————>服务器
4. 客户端<————返回数据，断开连接————服务器

> https 是五次握手，有个交换秘钥的过程，另外，http1.1 也会返回数据后断开连接，只是等一段时间再断开。

**HTTP的消息**

请求的数据：request

响应的数据：response

http 的 header：容量一般小于等于32K，去掉固定的一些内容，可用的也就20k多一点。所以数据比较小的时候可以用GET，因为GET的数据只能放在头中。

http 的 body/content：容量一般小于等于1G，但是不建议传大文件，因为HTTP默认情况下没有断点续传。

**OSI七层模型**

1. 物理层：通信工程的内容，材料、电压等东西。
2. 链路层：用于内网寻址，比如家里的局域内网。当然最终外网也要来到这一层(ARP、ICMP)
3. 网络层：用于外网寻址，路由器之外的网络（IP）
4. 传输层：通信的稳定性，数据别丢包（TCP）
5. 表现层：统一各个网络的结构，被传输层取代了
6. 会话层：让服务器记录状态，而不是无状态通信（服务器记不住客户端的状态，就是是否访问过），一般不需要会话层，都是通过cookie来保存一些状态。
7. 应用层：应用细节，FTP、HTTP、SMTP、POP3

> 实际应用中通常是五层模型，没有表现层和会话层，它们的功能被别的取代了。

**TCP**

- 传输控制协议
- 保证到达
- 保证质量
- 保证顺序
- 适用于对信号质量要求高的场景、延迟会略高，比如适用于文件下载、聊天

**UDP** 

- 用户数据报协议
- 不保证到达
- 不保证质量
- 不保证顺序
- 适应对信号质量没有绝对要求的场景，但是对延迟有很高要求，比如适用于直播、IP电话

### 表单

ajax和jsonp都是会表单的模拟，对于服务器来说，根本区分不出来表单还是ajax还是jsonp，除非加个特殊标记

#### 主要属性

action：提交的url

method：表单提交的方式，GET、POST、PUT、headerER、DELETE，也可以自定义，服务器识别就行

name：必须加、可以重复，后台就是通过 name 区分数据

#### 数据提交的方式

GET：数据是放在URL中能看见，容量有限，有缓存，利于分享和收藏（比如淘宝搜商品分享链接）

POST：数据放在HTTP的body中看不见，容量比较大，不缓存，无法分享收藏

> 安全性两者完全一样，只有https才是真安全。

#### 校验

表单的校验是在表单元素的 submit 事件中进行的。另外验证插件可以使用 validate

```js
const $ = document.querySelectorAll.bind(document);

let oForm = $('form')[0];
let oUser = document.getElementsByName('user')[0];

$pForm.onsubmit = function() {
	// 在这里进行验证
	// return false 就可以阻止提交
}
```